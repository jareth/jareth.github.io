<?xml version="1.0" encoding="UTF-8"?>
<task>
  <meta>
    <id>01</id>
    <name>Install and Configure Eleventy</name>
    <phase>1</phase>
    <status>pending</status>
    <dependencies>none</dependencies>
  </meta>

  <description>
    Install Eleventy and required plugins, create configuration files.
  </description>

  <steps>
    <step number="1.1">
      <action>Install Eleventy and required plugins</action>
      <command>yarn add -D @11ty/eleventy @11ty/eleventy-plugin-rss @11ty/eleventy-navigation</command>
      <notes>
        <note>eleventy-plugin-rss replaces jekyll-feed</note>
        <note>eleventy-navigation replaces data-driven nav</note>
      </notes>
    </step>

    <step number="1.2">
      <action>Create Eleventy configuration file</action>
      <file>.eleventy.js</file>
      <content><![CDATA[
const pluginRss = require("@11ty/eleventy-plugin-rss");
const pluginNavigation = require("@11ty/eleventy-navigation");
const yaml = require("js-yaml");

module.exports = function(eleventyConfig) {
  // Plugins
  eleventyConfig.addPlugin(pluginRss);
  eleventyConfig.addPlugin(pluginNavigation);

  // Support YAML data files
  eleventyConfig.addDataExtension("yml", contents => yaml.load(contents));

  // Passthrough copy for assets
  eleventyConfig.addPassthroughCopy("assets/images");
  eleventyConfig.addPassthroughCopy("dist");

  // Watch targets
  eleventyConfig.addWatchTarget("./assets/css/");
  eleventyConfig.addWatchTarget("./dist/");

  // Collections
  eleventyConfig.addCollection("projects", function(collectionApi) {
    return collectionApi.getFilteredByGlob("_projects/*.md");
  });

  eleventyConfig.addCollection("posts", function(collectionApi) {
    return collectionApi.getFilteredByGlob("_posts/*.md");
  });

  // Liquid options (for Jekyll compatibility)
  eleventyConfig.setLiquidOptions({
    dynamicPartials: false,
    strictFilters: false
  });

  return {
    dir: {
      input: ".",
      output: "_site",
      includes: "_includes",
      layouts: "_layouts",
      data: "_data"
    },
    templateFormats: ["html", "md", "liquid"],
    markdownTemplateEngine: "liquid",
    htmlTemplateEngine: "liquid"
  };
};
]]></content>
    </step>

    <step number="1.3">
      <action>Install js-yaml for YAML data file support</action>
      <command>yarn add -D js-yaml</command>
    </step>

    <step number="1.4">
      <action>Create .eleventyignore file</action>
      <file>.eleventyignore</file>
      <content><![CDATA[
node_modules/
README.md
CLAUDE.md
eleventy-migration.xml
_site/
dist/
*.config.js
]]></content>
    </step>
  </steps>

  <verification>
    <check>eleventy packages appear in package.json devDependencies</check>
    <check>.eleventy.js file exists and is valid JavaScript</check>
    <check>.eleventyignore file exists</check>
  </verification>
</task>
